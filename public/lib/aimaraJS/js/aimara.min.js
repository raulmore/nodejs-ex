!function(){function e(e,n,t){return element=document.createElement(e),void 0!=n&&(element.id=n),void 0!=t&&(element.className=t),element}function n(e,n,t){return element=document.createElement("img"),void 0!=e&&(element.id=e),void 0!=n&&(element.className=n),void 0!=t&&(element.src=t),element}function t(e,n){return element=document.createElement("i"),void 0!=e&&(element.id=e),void 0!=n&&(element.className=n),element}window.createTree=function(l,i,d){var o={name:"tree",div:l,ulElement:null,childNodes:[],backcolor:i,contextMenu:d,selectedNode:null,nodeCounter:0,contextMenuDiv:null,rendered:!1,createNode:function(e,n,t,l,i,d){if(v_tree=this,node={id:"node_"+this.nodeCounter,text:e,icon:t,parent:l,expanded:n,childNodes:[],tag:i,contextMenu:d,elementLi:null,removeNode:function(){v_tree.removeNode(this)},toggleNode:function(e){v_tree.toggleNode(this)},expandNode:function(e){v_tree.expandNode(this)},expandSubtree:function(){v_tree.expandSubtree(this)},setText:function(e){v_tree.setText(this,e)},setIcon:function(e){v_tree.setIcon(this,e)},collapseNode:function(){v_tree.collapseNode(this)},collapseSubtree:function(){v_tree.collapseSubtree(this)},removeChildNodes:function(){v_tree.removeChildNodes(this)},createChildNode:function(e,n,t,l,i){return v_tree.createNode(e,n,t,this,l,i)}},this.nodeCounter++,this.rendered)if(void 0==l)this.drawNode(this.ulElement,node),this.adjustLines(this.ulElement,!1);else{var o=l.elementLi.getElementsByTagName("ul")[0];0==l.childNodes.length&&(l.expanded?(l.elementLi.getElementsByTagName("ul")[0].style.display="block",v_img=l.elementLi.getElementsByTagName("img")[0],v_img.style.visibility="visible",v_img.src="lib/aimaraJS/images/collapse.png",v_img.id="toggle_off"):(l.elementLi.getElementsByTagName("ul")[0].style.display="none",v_img=l.elementLi.getElementsByTagName("img")[0],v_img.style.visibility="visible",v_img.src="lib/aimaraJS/images/expand.png",v_img.id="toggle_on")),this.drawNode(o,node),this.adjustLines(o,!1)}return void 0==l?(this.childNodes.push(node),node.parent=this):l.childNodes.push(node),node},drawTree:function(){this.rendered=!0;var n=document.getElementById(this.div);n.innerHTML="",ulElement=e("ul",this.name,"tree"),this.ulElement=ulElement;for(var t=0;t<this.childNodes.length;t++)this.drawNode(ulElement,this.childNodes[t]);n.appendChild(ulElement),this.adjustLines(document.getElementById(this.name),!0)},drawNode:function(l,i){v_tree=this;var d=null;null!=i.icon&&(d=t(null,i.icon));var o=document.createElement("li");i.elementLi=o;var s=e("span",null,"node"),a=null;0==i.childNodes.length?(a=n("toggle_off","exp_col","lib/aimaraJS/images/collapse.png")).style.visibility="hidden":a=i.expanded?n("toggle_off","exp_col","lib/aimaraJS/images/collapse.png"):n("toggle_on","exp_col","lib/aimaraJS/images/expand.png"),s.ondblclick=function(){v_tree.doubleClickNode(i)},a.onclick=function(){v_tree.toggleNode(i)},s.onclick=function(){v_tree.selectNode(i)},s.oncontextmenu=function(e){v_tree.selectNode(i),v_tree.nodeContextMenu(e,i)},void 0!=d&&s.appendChild(d),v_a=e("a",null,null),v_a.innerHTML=i.text,s.appendChild(v_a),o.appendChild(a),o.appendChild(s),l.appendChild(o);var c=e("ul","ul_"+i.id,null);if(o.appendChild(c),i.childNodes.length>0){i.expanded||(c.style.display="none");for(var u=0;u<i.childNodes.length;u++)this.drawNode(c,i.childNodes[u])}},setText:function(e,n){e.elementLi.getElementsByTagName("span")[0].lastChild.innerHTML=n,e.text=n},setIcon:function(e,n){e.elementLi.getElementsByTagName("span")[0].firstChild.className=n,e.icon=n},expandTree:function(){for(var e=0;e<this.childNodes.length;e++)this.childNodes[e].childNodes.length>0&&this.expandSubtree(this.childNodes[e])},expandSubtree:function(e){this.expandNode(e);for(var n=0;n<e.childNodes.length;n++)e.childNodes[n].childNodes.length>0&&this.expandSubtree(e.childNodes[n])},collapseTree:function(){for(var e=0;e<this.childNodes.length;e++)this.childNodes[e].childNodes.length>0&&this.collapseSubtree(this.childNodes[e])},collapseSubtree:function(e){this.collapseNode(e);for(var n=0;n<e.childNodes.length;n++)e.childNodes[n].childNodes.length>0&&this.collapseSubtree(e.childNodes[n])},expandNode:function(e){if(e.childNodes.length>0&&0==e.expanded){void 0!=this.nodeBeforeOpenEvent&&this.nodeBeforeOpenEvent(e);var n=e.elementLi.getElementsByTagName("img")[0];e.expanded=!0,n.id="toggle_off",n.src="lib/aimaraJS/images/collapse.png",elem_ul=n.parentElement.getElementsByTagName("ul")[0],elem_ul.style.display="block",void 0!=this.nodeAfterOpenEvent&&this.nodeAfterOpenEvent(e)}},collapseNode:function(e){if(e.childNodes.length>0&&1==e.expanded){var n=e.elementLi.getElementsByTagName("img")[0];e.expanded=!1,void 0!=this.nodeBeforeCloseEvent&&this.nodeBeforeCloseEvent(e),n.id="toggle_on",n.src="lib/aimaraJS/images/expand.png",elem_ul=n.parentElement.getElementsByTagName("ul")[0],elem_ul.style.display="none"}},toggleNode:function(e){e.childNodes.length>0&&(e.expanded?e.collapseNode():e.expandNode())},doubleClickNode:function(e){this.toggleNode(e)},selectNode:function(e){e.elementLi.getElementsByTagName("span")[0].className="node_selected",null!=this.selectedNode&&this.selectedNode!=e&&(this.selectedNode.elementLi.getElementsByTagName("span")[0].className="node"),this.selectedNode=e},removeNode:function(e){var n=e.parent.childNodes.indexOf(e);"last"==e.elementLi.className&&0!=n&&(e.parent.childNodes[n-1].elementLi.className+="last",e.parent.childNodes[n-1].elementLi.style.backgroundColor=this.backcolor),e.elementLi.parentNode.removeChild(e.elementLi),e.parent.childNodes.splice(n,1),0==e.parent.childNodes.length&&(e.parent.elementLi.getElementsByTagName("img")[0].style.visibility="hidden")},removeChildNodes:function(e){if(e.childNodes.length>0){var n=e.elementLi.getElementsByTagName("ul")[0];e.elementLi.getElementsByTagName("img")[0].style.visibility="hidden",e.childNodes=[],n.innerHTML=""}},nodeContextMenu:function(t,l){if(2==t.button&&(t.preventDefault(),t.stopPropagation(),void 0!=l.contextMenu)){v_tree=this;var i,d=this.contextMenu[l.contextMenu];null==this.contextMenuDiv?(i=e("ul","ul_cm","menu"),document.body.appendChild(i)):i=this.contextMenuDiv,i.innerHTML="";var o=t.pageX-5,s=t.pageY-5;i.style.display="block",i.style.position="absolute",i.style.left=o+"px",i.style.top=s+"px";for(var a=0;a<d.elements.length;a++)!function(t){var o=e("li",null,null),s=e("span",null,null);s.onclick=function(){d.elements[t].action(l)};var a=e("a",null,null),c=e("ul",null,"sub-menu");if(a.appendChild(document.createTextNode(d.elements[t].text)),o.appendChild(s),void 0!=d.elements[t].icon){var u=n("null","null",d.elements[t].icon);o.appendChild(u)}if(o.appendChild(a),o.appendChild(c),i.appendChild(o),void 0!=d.elements[t].submenu){var m=e("div",null,null);m.appendChild(n(null,"menu_img","lib/aimaraJS/images/right.png")),o.appendChild(m),v_tree.contextMenuLi(d.elements[t].submenu,c,l)}}(a);this.contextMenuDiv=i}},contextMenuLi:function(t,l,i){v_tree=this;for(var d=0;d<t.elements.length;d++)!function(d){var o=e("li",null,null),s=e("span",null,null);s.onclick=function(){t.elements[d].action(i)};var a=e("a",null,null),c=e("ul",null,"sub-menu");if(a.appendChild(document.createTextNode(t.elements[d].text)),o.appendChild(s),void 0!=t.elements[d].icon){var u=n("null","null",t.elements[d].icon);o.appendChild(u)}if(o.appendChild(a),o.appendChild(c),l.appendChild(o),void 0!=t.elements[d].p_submenu){var m=e("div",null,null);m.appendChild(n(null,"menu_img","lib/aimaraJS/images/right.png")),o.appendChild(m),v_tree.contextMenuLi(t.elements[d].p_submenu,c,i)}}(d)},adjustLines:function(e,n){var t=e,l=[];if(t.childNodes.length>0&&(l=[t],n))for(d=0;d<t.getElementsByTagName("ul").length;d++){var i=t.getElementsByTagName("ul")[d];0!=i.childNodes.length&&(l[l.length]=i)}for(var d=0;d<l.length;d++){for(var o=l[d].lastChild;!o.tagName||"li"!=o.tagName.toLowerCase();)o=o.previousSibling;o.className+="last",o.style.backgroundColor=this.backcolor,null!=(o=o.previousSibling)&&"li"==o.tagName.toLowerCase()&&(o.className="",o.style.backgroundColor="transparent")}}};return window.onclick=function(){null!=o.contextMenuDiv&&(o.contextMenuDiv.style.display="none")},o}}();
